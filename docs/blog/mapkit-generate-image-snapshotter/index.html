<!DOCTYPE html>
<html lang="en-us">

  <head>
  <meta charset="utf-8">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Generate MapView Snapshot with Snapshotter</title>
  <meta name="author" content="" />

  

  

  <meta name="generator" content="Hugo 0.32.3" />

  <link href='//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,700,800' rel='stylesheet' type='text/css'>

  
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  
  <link href="https://apps.rogermolas.com/css/animate.css" rel="stylesheet">

  
  
    <link href="https://apps.rogermolas.com/css/style.default.css" rel="stylesheet" id="theme-stylesheet">
  


  
  <link href="https://apps.rogermolas.com/css/custom.css" rel="stylesheet">

  
  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
  <link rel="shortcut icon" href="https://apps.rogermolas.com/img/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" href="https://apps.rogermolas.com/img/apple-touch-icon.png" />
  

  <link href="https://apps.rogermolas.com/css/owl.carousel.css" rel="stylesheet">
  <link href="https://apps.rogermolas.com/css/owl.theme.css" rel="stylesheet">

  <link rel="alternate" href="https://apps.rogermolas.com/index.xml" type="application/rss+xml" title="Universal">

  
  <meta property="og:title" content="Generate MapView Snapshot with Snapshotter" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/blog/mapkit-generate-image-snapshotter//" />
  <meta property="og:image" content="" />

</head>


  <body>

    <div id="all">

        <header>

          <div class="navbar-affixed-top" data-spy="affix" data-offset-top="200">

    <div class="navbar navbar-default yamm" role="navigation" id="navbar">

        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand home" href="https://apps.rogermolas.com/">
                    <img src="https://apps.rogermolas.com/img/logo.png" alt="Generate MapView Snapshot with Snapshotter logo" class="hidden-xs hidden-sm">
                    <img src="https://apps.rogermolas.com/img/logo-small.png" alt="Generate MapView Snapshot with Snapshotter logo" class="visible-xs visible-sm">
                    <span class="sr-only">Generate MapView Snapshot with Snapshotter - go to homepage</span>
                </a>
                <div class="navbar-buttons">
                    <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse" data-target="#navigation">
                      <span class="sr-only">Toggle Navigation</span>
                        <i class="fa fa-align-justify"></i>
                    </button>
                </div>
            </div>
            

            <div class="navbar-collapse collapse" id="navigation">
                <ul class="nav navbar-nav navbar-right">
                  
                  <li class="dropdown">
                    
                    <a href="/">HOME</a>
                    
                  </li>
                  
                  <li class="dropdown">
                    
                    <a href="http://www.rogermolas.com/blog/">BLOGS</a>
                    
                  </li>
                  
                </ul>
            </div>
            

            <div class="collapse clearfix" id="search">

                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search">
                        <span class="input-group-btn">

                    <button type="submit" class="btn btn-template-main"><i class="fa fa-search"></i></button>

                </span>
                    </div>
                </form>

            </div>
            

        </div>
    </div>
    

</div>




        </header>

        <div id="heading-breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h1>Generate MapView Snapshot with Snapshotter</h1>
            </div>
        </div>
    </div>
</div>


        <div id="content">
            <div class="container">

                <div class="row">

                    

                    <div class="col-md-9" id="blog-post">

                        <p class="text-muted text-uppercase mb-small text-right">By <a href="#">rogermolas</a> | February 12, 2018</p>

                        <div id="post-content">
                          

<p><a href="https://developer.apple.com/documentation/mapkit/mkmapsnapshot"><code>MKMapSnapshotter</code></a> is use in creating an image representation of a map view. Previously, other developers use <a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/CocoaDrawingGuide/GraphicsContexts/GraphicsContexts.html"><code>UIGraphicsContext</code></a>, but now images can reliably be created for any particular region and perspective.</p>

<h3 id="creating-a-map-view-snapshot">Creating a Map View Snapshot</h3>

<pre><code>let mapSnapshotOptions = MKMapSnapshotOptions()
mapSnapshotOptions.region = mapView.region
mapSnapshotOptions.scale = UIScreen.main.scale
mapSnapshotOptions.size = mapView.frame.size
mapSnapshotOptions.showsBuildings = true
mapSnapshotOptions.showsPointsOfInterest = true

let snapShotter = MKMapSnapshotter(options: mapSnapshotOptions)
snapShotter.start { (snap, error) in
    let image = snap?.image
    imageView.image = image
}
</code></pre>

<p>According to Apple&rsquo;s <a href="https://developer.apple.com/documentation/mapkit/mkmapsnapshot">MKMapSnapshot</a> doc</p>

<blockquote>
<p>Snapshot images do not include any custom overlays or annotations that your app added to the map view. If you want your annotations and overlays to appear on the final image, you must draw them yourself.</p>
</blockquote>

<h3 id="draw-stroke-color-in-image">Draw Stroke Color In Image</h3>

<pre><code>let image = snap?.image
UIGraphicsBeginImageContextWithOptions((image?.size)!, true, (image?.scale)!)
image?.draw(at: CGPoint(x: 0, y: 0))

let context = UIGraphicsGetCurrentContext()
context!.setStrokeColor(UIColor.blue.cgColor)
context!.setLineWidth(2.0)
context!.beginPath()

for (index, location) in locations.enumerated() {
    let coordinates = CLLocationCoordinate2DMake(location.latitude, location.longitude)
    let point = snap?.point(for: coordinates)
    if index == 0 {
        context?.move(to: point!)
    } else {
        context?.addLine(to:point!)
    }
}
context?.strokePath()
let finalImage = UIGraphicsGetImageFromCurrentImageContext()
UIGraphicsEndImageContext()
imageView.image = finalImage
</code></pre>

<p>The stroke color are rendered separately. By using <code>point(for:)</code>  it converts the specified map coordinate to a point in the coordinate space of the map image.</p>

                        </div>
                        
                        

                    </div>
                    

                    

                    

                    <div class="col-md-3">

                        

                        

<div class="panel panel-default sidebar-menu">

    <div class="panel-heading">
      <h3 class="panel-title">Search</h3>
    </div>

    <div class="panel-body">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" role="search">
            <div class="input-group">
                <input type="search" name="q" class="form-control" placeholder="Search">
                <input type="hidden" name="sitesearch" value="https://apps.rogermolas.com/">
                <span class="input-group-btn">
                    <button type="submit" class="btn btn-template-main"><i class="fa fa-search"></i></button>
                </span>
            </div>
        </form>
    </div>
</div>







<div class="panel panel-default sidebar-menu">

    <div class="panel-heading">
      <h3 class="panel-title">Categories</h3>
    </div>

    <div class="panel-body">
        <ul class="nav nav-pills nav-stacked">
            
            <li><a href="https://apps.rogermolas.com/categories/gcd">gcd (1)</a>
            </li>
            
            <li><a href="https://apps.rogermolas.com/categories/mapkit">mapkit (1)</a>
            </li>
            
            <li><a href="https://apps.rogermolas.com/categories/mkmapsnapshot">mkmapsnapshot (1)</a>
            </li>
            
            <li><a href="https://apps.rogermolas.com/categories/string">string (1)</a>
            </li>
            
            <li><a href="https://apps.rogermolas.com/categories/swift3">swift3 (1)</a>
            </li>
            
            <li><a href="https://apps.rogermolas.com/categories/swift4">swift4 (1)</a>
            </li>
            
            <li><a href="https://apps.rogermolas.com/categories/threading">threading (1)</a>
            </li>
            
        </ul>
    </div>
</div>








<div class="panel sidebar-menu">
    <div class="panel-heading">
      <h3 class="panel-title">Tags</h3>
    </div>

    <div class="panel-body">
        <ul class="tag-cloud">
            
            <li><a href="https://apps.rogermolas.com/tags/gcd"><i class="fa fa-tags"></i> gcd</a>
            </li>
            
            <li><a href="https://apps.rogermolas.com/tags/mapkit"><i class="fa fa-tags"></i> mapkit</a>
            </li>
            
            <li><a href="https://apps.rogermolas.com/tags/mkmapsnapshot"><i class="fa fa-tags"></i> mkmapsnapshot</a>
            </li>
            
            <li><a href="https://apps.rogermolas.com/tags/multi-threading"><i class="fa fa-tags"></i> multi-threading</a>
            </li>
            
            <li><a href="https://apps.rogermolas.com/tags/string"><i class="fa fa-tags"></i> string</a>
            </li>
            
            <li><a href="https://apps.rogermolas.com/tags/swift3"><i class="fa fa-tags"></i> swift3</a>
            </li>
            
            <li><a href="https://apps.rogermolas.com/tags/swift4"><i class="fa fa-tags"></i> swift4</a>
            </li>
            
        </ul>
    </div>
</div>






                        

                    </div>
                    

                    

                </div>
                

            </div>
            
        </div>
        

        <footer id="footer">
    <div class="container">

        

        <div class="col-md-4 col-sm-6">

            

        </div>
        

        

    </div>
    
</footer>







<div id="copyright">
    <div class="container">
        <div class="col-md-12">
            
            <p class="pull-left">Copyright (c) 2018, Roger Molas; all rights reserved.</p>
            
            <p class="pull-right">
              Template by <a href="http://bootstrapious.com/free-templates">Bootstrapious</a>.
              

              Ported to Hugo by <a href="https://github.com/devcows/hugo-universal-theme">DevCows</a>
            </p>
        </div>
    </div>
</div>





    </div>
    

    
<script src="//code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0/jquery.counterup.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-parallax/1.1.3/jquery-parallax.js"></script>

<script src="//maps.googleapis.com/maps/api/js?v=3.exp"></script>

<script src="https://apps.rogermolas.com/js/hpneo.gmaps.js"></script>
<script src="https://apps.rogermolas.com/js/gmaps.init.js"></script>
<script src="https://apps.rogermolas.com/js/front.js"></script>


<script src="https://apps.rogermolas.com/js/owl.carousel.min.js"></script>


  </body>
</html>
